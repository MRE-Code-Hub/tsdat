#-----------------------------------------------------------------
dataset_definition:  # Describes the dataset that will be produced
  attributes:
    title: Buoy Dataset for Buoy \#120
    description: Example ingest dataset used for demonstration purposes.
    conventions: MHKiT-Cloud Data Standards v. 1.0
    doi: 10.21947/1671051
    institution: PNNL
    code_url: https://github.com/clansing/tsdat/releases/tag/1.0
    location_id: humboldt_z05
    instrument_id: lidar_buoy
    data_level: b1
    location_meaning: Buoy is located of the coast of Humboldt, CA
    instrument_name: Wind Sentinel
    serial_number: '000011312'
    instrument_meaning: Self-powered floating buoy hosting a suite of meteorological and marine instruments.
    instrument_manufacturer: AXYS Technologies Inc.
    sampling_interval: 10 min

  dimensions:
    time:
        length: unlimited

  variables:

    time:
      input:
        # Name of the variable in the raw data
        name: DataTimeStamp(DateTime)
        converter:
          classname: tsdat.utils.converters.StringTimeConverter
          parameters:
            timezone: US/Pacific
            time_format: "%Y-%m-%d %H:%M:%S"
      dims: [time]
      type: long
      attrs:
        long_name: Time offset from epoch
        standard_name: time
        units: seconds since 1970-01-01T00:00:00

    temp_mean:
      input:
        name: ValueAverage(Double)
        units: degC
        converter:
          classname: tsdat.utils.converters.DefaultConverter
      dims: [time]
      type: double
      attrs:
        long_name: Mean temperature
        comment: Rolling 10-minute average sea surface temperature. Aligned such that the temperature reported at time 'n' represents the average across the interval (n-1, n].
        units: degC
        valid_delta: 3.0
        valid_range: [-50, 150]
        _FillValue: -9999

    temp_min:
      input:
        name: ValueMin(Double)
        units: degC
      dims: [time]
      type: double
      attrs:
        long_name: Minimum temperature
        comment: Minimum value used in rolling 10-minute average sea surface temperature.
        units: degC
        valid_delta: 3.0
        valid_range: [-50, 150]
        _FillValue: -9999

#-----------------------------------------------------------------
coordinate_variable_qc_tests:  # Define QC tests for coordinate variables

  missing:
    variables:
      - ALL
    operator:
      classname: tsdat.qc.operators.CheckMissing
    error_handlers:
      fail_pipeline:
        classname: tsdat.qc.error_handlers.FailPipeline

  monotonic:
    variables:
      - All
    operator:
      classname: tsdat.qc.operators.CheckMonotonic
    error_handlers:
      fail_pipeline:
        classname: tsdat.qc.error_handlers.FailPipeline

#-----------------------------------------------------------------
qc_tests:  # Define QC tests for non-coordinate variables

    missing:
        qc_bit: 1
        description: "Value is equal to _FillValue or NaN"
        assessment: Bad
        variables:
          - ALL  # keyword to apply test to all variables
        operator:
          classname: tsdat.qc.operators.CheckMissing

    fail_min:
        qc_bit: 2
        description: "Value is less than the fail_range."
        assessment: Bad
        variables:
          - ALL
        operator:
          classname: tsdat.qc.operators.CheckFailMin

    fail_max:
        qc_bit: 3
        description: "Value is greater than the fail_range."
        assessment: Bad
        variables:
          - ALL
        operator:
          classname: tsdat.qc.operators.CheckFailMax

    warn_min:
        qc_bit: 4
        description: "Value is less than the warn_range."
        assessment: Indeterminate
        variables:
          - ALL
        operator:
          classname: tsdat.qc.operators.CheckWarnMin

    warn_max:
        qc_bit: 5
        description: "Value is greater than the warn_range."
        assessment: Indeterminate
        variables:
          - ALL
        operator:
          classname: tsdat.qc.operators.CheckWarnMax

    valid_delta:
        qc_bit: 6
        description: "Difference between current and previous values exceeds valid_delta."
        assessment: Indeterminate
        variables:
          - ALL
        operator:
          classname: tsdat.qc.operators.CheckValidDelta
          parameters:
            dim: time
